webpackJsonp([2],{"/vp9":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("4YfN"),l=n.n(i),s=n("9rMa"),a={components:{"v-selectTable":n("t/0k").a},computed:l()({},Object(s.e)({prom:function(e){return e.prom},user:function(e){return e.user}})),data:function(){return{uploadAction:"",head:{},uploadHead:{},needTabel:[],columns:{title:"名称"},table:[],multipleSelection:[],fileList:[],isloading:!1,isshow:!1}},created:function(){var e=this;sessionStorage.getItem("pname")&&this.setpname_prom(sessionStorage.getItem("pname")),window.addEventListener("beforeunload",function(){sessionStorage.setItem("pname",sessionStorage.getItem("pname"))}),this.head={projectname:this.prom.prom_pname,username:JSON.parse(sessionStorage.user).username,filetype:"bulkcm"},this.uploadHead={projectname:this.prom.prom_pname,username:JSON.parse(sessionStorage.user).username,filetype:"bulkcm",Authorization:"bearer "+sessionStorage.getItem("token")},this.uploadAction=this.user.httppath+"/api/Bulkcm/Upload";var t={headers:this.head};this.$http.post(this.user.httppath+"/api/Bulkcm/GetTables",{},t).then(function(t){e.needTabel=t,e.total=e.needTabel.length;for(var n=0;n<t.length;n++)"True"===t[n].isOk&&e.table.push(e.needTabel[n])}).catch(function(t){e.$notify({title:"警告",message:t,type:"warning"})}),console.log(this.table),setTimeout(function(){e.$refs.seltab.toggleSelection(e.table)},250)},methods:l()({},Object(s.d)(["setpname_prom"]),{parm:function(){this.isshow=!this.isshow},analysis:function(){"default"!==this.prom.prom_pname?this.dbInput():this.$notify({title:"警告",message:"没有权限对公有工程进行数据入库",type:"warning"})},dbInput:function(){var e=this;this.isloading=!0;var t=[];for(var n in this.multipleSelection=this.$refs.seltab.multipleSelection,this.multipleSelection)t.push(this.multipleSelection[n].title);this.$http.post(this.user.httppath+"/api/Bulkcm/BulkParse",{tableName:t},{headers:this.head}).then(function(t){e.isloading=!1,e.$notify({title:"成功",message:"解析完成",type:"success"})}).catch(function(t){e.isloading=!1,e.$notify({title:"警告",message:t,type:"warning"})})},submitUpload:function(){"default"===this.prom.prom_pname?this.$notify({title:"警告",message:"没有权限对公共工程进行操作",type:"warning"}):this.$refs.upload.submit()},handleRemove:function(e,t){console.log("这是函数 handleRemove")},handlePreview:function(e){console.log("这是函数 handlePreview")}}),destroyed:function(){this.needTabel=[]}},o={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-main",[n("br"),e._v(" "),n("el-upload",{ref:"upload",staticClass:"elmro",attrs:{action:e.uploadAction,headers:e.uploadHead,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"file-list":e.fileList,"auto-upload":!1,limit:1e3,multiple:!0,accept:".zip, .xml, .gz"}},[n("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持.zip,.xml,.gz格式的文件")]),e._v(" "),n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("上传到服务器")])],1),e._v(" "),n("el-button",{staticStyle:{width:"80px","margin-left":"2px"},attrs:{type:"primary",size:"mini"},on:{click:e.parm}},[e._v("参数配置")]),e._v(" "),n("el-button",{staticStyle:{width:"80px","margin-left":"2px"},attrs:{type:"primary",loading:e.isloading,size:"mini"},on:{click:e.analysis}},[e._v("解析")]),e._v(" "),n("br"),e._v(" "),n("br"),e._v(" "),e.isshow?n("div",[n("h3",[e._v("待解析进数据库的表")]),e._v(" "),n("v-selectTable",{ref:"seltab",attrs:{tableData:e.needTabel,columns:e.columns}})],1):e._e()],1)],1)},staticRenderFns:[]};var r=n("C7Lr")(a,o,!1,function(e){n("RYOh")},null,null);t.default=r.exports},RYOh:function(e,t){},"t/0k":function(e,t,n){"use strict";var i=n("ZLEe"),l=n.n(i),s={computed:{tables:function(){var e=this,t=this.search;return t?this.tableData.filter(function(n){return l()(n).some(function(i){return!!e.columns.hasOwnProperty(i)&&String(n[i]).toLowerCase().indexOf(t)>-1})}):this.tableData}},props:{columns:{type:Object,default:function(){}},tableData:{type:Array,default:function(){return[]}}},data:function(){return{search:"",multipleSelection:[]}},methods:{toggleSelection:function(e){var t=this;e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){console.log("handleSelectionChange 函数")},selects:function(e,t){console.log("选择某一项触发的函数"),console.log(e),this.multipleSelection=e}},watch:{tables:function(e){var t=this;setTimeout(function(){t.toggleSelection(t.multipleSelection)},250)}}},a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入关键字进行过滤","prefix-icon":"el-icon-search",size:"mini",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tables,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange,select:e.selects}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),e._l(e.columns,function(t,i){return n("el-table-column",{key:i,attrs:{label:t,"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row[i]))]}}])})})],2)],1)},staticRenderFns:[]},o=n("C7Lr")(s,a,!1,null,null,null);t.a=o.exports}});
//# sourceMappingURL=2.0acedf80770012cafb23.js.map